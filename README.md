# üéì Connect AITU Backend

Backend API –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º –≤ –º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—É –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞.

[![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.115+-green.svg)](https://fastapi.tiangolo.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### **–î–≤–∞ —Ä–µ–∂–∏–º–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:**

**üéØ –°–≤–æ–±–æ–¥–Ω—ã–π —Ä–µ–∂–∏–º (Practice Mode):**
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ 20 –≤–æ–ø—Ä–æ—Å–æ–≤
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
- –û–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (7 –¥–Ω–µ–π)

**üìù –†–µ–∂–∏–º —ç–∫–∑–∞–º–µ–Ω–∞ (Exam Mode):**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—ã:
  - **–ü—Ä–æ—Ñ–∏–ª—å–Ω–∞—è:** 50 –≤–æ–ø—Ä–æ—Å–æ–≤, 90 –º–∏–Ω—É—Ç
  - **–ù–∞—É—á–Ω–æ-–ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∞—è:** 130 –≤–æ–ø—Ä–æ—Å–æ–≤, 180 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ —Ç–∞–π–º–µ—Ä—É (Celery)
- –ü—Ä–æ–∫—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

### **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (access + refresh)
- Role-based access control
- –í–æ–ø—Ä–æ—Å—ã –ë–ï–ó –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –±–µ–∫–µ–Ω–¥–µ
- Rate limiting (60 req/min)
- Password hashing (bcrypt)

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastAPI** - –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLAlchemy 2.0** - ORM (async)
- **PostgreSQL 16** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis 7** - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Celery** - –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- **Alembic** - –ú–∏–≥—Ä–∞—Ü–∏–∏
- **Pydantic 2.0** - –í–∞–ª–∏–¥–∞—Ü–∏—è

## üì¶ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –° Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-org/connect-aitu-backend.git
cd connect-aitu-backend

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec backend alembic upgrade head

# 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
docker-compose exec backend python scripts/init_data.py
docker-compose exec backend python scripts/create_admin.py

# API –¥–æ—Å—Ç—É–ø–µ–Ω: http://localhost:8000
# Docs: http://localhost:8000/docs
```

### –ë–µ–∑ Docker

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env
cp .env.example .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –∏ Redis
# (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É)

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
python scripts/init_data.py
python scripts/create_admin.py

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å
# –¢–µ—Ä–º–∏–Ω–∞–ª 1:
python -m app.main

# –¢–µ—Ä–º–∏–Ω–∞–ª 2:
celery -A app.tasks.celery_app worker --beat --loglevel=info
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Swagger UI
http://localhost:8000/docs

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints:

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
```
POST /api/auth/login       - –í—Ö–æ–¥
POST /api/auth/refresh     - –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
```

**–°–≤–æ–±–æ–¥–Ω—ã–π —Ä–µ–∂–∏–º:**
```
POST /api/practice/start
GET  /api/practice/{subject}/questions
POST /api/practice/{subject}/submit-answer
```

**–†–µ–∂–∏–º —ç–∫–∑–∞–º–µ–Ω–∞:**
```
POST /api/exam/start
GET  /api/exam/{attempt_id}/questions
POST /api/exam/{attempt_id}/answer
POST /api/exam/{attempt_id}/submit
```

**–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:**
```
GET    /api/admin/users
POST   /api/admin/users
GET    /api/admin/attempts
```

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
app/
‚îú‚îÄ‚îÄ api/         # Endpoints (—Ä–æ—É—Ç–µ—Ä—ã)
‚îú‚îÄ‚îÄ core/        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ models/      # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/     # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îî‚îÄ‚îÄ tasks/       # Celery –∑–∞–¥–∞—á–∏
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**Models:** User, Major, Subject, Question, ExamAttempt, ExamAnswer, ProctoringEvent

**Services:** auth, question, practice, exam, proctoring, redis

**Celery Tasks:** auto_finish_exam, cleanup_expired_exams, cleanup_old_attempts

## üö¢ Production –¥–µ–ø–ª–æ–π

### 1. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

```bash
# Let's Encrypt
sudo certbot certonly --standalone -d connect-aitu.me
sudo cp /etc/letsencrypt/live/connect-aitu.me/*.pem ./ssl/
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env

```bash
ENVIRONMENT=production
DEBUG=false
SECRET_KEY=$(openssl rand -hex 32)
DATABASE_URL=postgresql+asyncpg://...
REDIS_URL=redis://...
CORS_ORIGINS=https://connect-aitu.me
```

### 3. –ó–∞–ø—É—Å–∫

```bash
docker-compose -f docker-compose.prod.yml up -d --build
docker-compose exec backend alembic upgrade head
docker-compose exec backend python scripts/init_data.py
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **Flower (Celery):** http://your-server:5555
- **–õ–æ–≥–∏:** `docker-compose logs -f backend`
- **Health:** https://connect-aitu.me/health

## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
alembic revision --autogenerate -m "Description"
alembic upgrade head
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest
pytest --cov=app tests/
```

### Pre-commit

```bash
pip install pre-commit
pre-commit install
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üë• –ö–æ–º–∞–Ω–¥–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π Connect AITU

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** 2025-10-25
